import numpy as np
from scipy.io import loadmat, savemat
import numpy.fft as FFT
# import mat73
from einops import rearrange
import os
import re

k_raw_list = ['/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_148/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_142/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_107/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_114/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_113/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_119/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_121/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_138/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_136/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_141/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_104/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_125/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_117/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_109/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_146/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_131/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_139/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_118/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_120/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_127/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_150/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_115/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_134/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_129/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_124/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_116/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_137/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_101_150/PREVENT_105/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_082/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_088/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_066/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_075/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_096/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_078/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_059/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_053/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_061/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_065/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_076/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_058/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_060/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_097/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_079/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_073/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_090/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_089/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_067/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_055/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_051/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_087/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_063/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_070/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_077/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_099/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_093/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_51_100/PREVENT_056/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_220/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_212/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_233/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_239/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_206/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_243/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_215/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_250/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_223/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_211/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_247/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_202/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_205/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_240/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_237/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_224/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_207/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_238/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_245/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_219/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_225/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_204/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_236/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_241/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_246/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_203/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_228/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_201_250/PREVENT_222/study/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_021/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_038/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_045/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_032/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_048/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_035/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_042/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_026/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_014/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_022/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_003/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_009/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_031/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_046/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_041/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_017/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_015/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_043/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_001/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_033/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_044/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_018/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_020/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_005/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_002/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/TIA_brooklyn/QSMpatients_1_50/PREVENT_047/QSM_SPGR_GE/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-05-27 RR-042/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-18 RR-188/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-29 RR-053/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-03-10 RR-021/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-24 RR-162/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-04-19 RR-155/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-10 RR-164/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-08 RR-175/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-11 RR-094/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-02-27 RR-142/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-10 RR-074/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-16 RR-173/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-02 RR-167/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-07-28 RR-187/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-07-21 RR-184/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-01-14 RR-010/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-24 RR-076/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-07 RR-113/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-03 RR-162/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-12-22 RR-158/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-25 RR-158/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-01 RR-168/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-06 RR-084/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-01-22 RR-012/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-19 RR-031/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-03 RR-049/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-21 RR-058/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-01-28 RR-013/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-06 RR-096/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-15 RR-088/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-23 RR-069/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-17 RR-081/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-04 RR-067/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-02 RR-193/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-04 RR-105/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-09-13 RR-198/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2018-01-09 RR-214/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-05 RR-176/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2015-11-25 RR-006/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2015-12-15 RR-007/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-03 RR-129/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-23 RR-148/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-31 RR-106/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-22 RR-210/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-09-28 RR-180/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-30 RR-057/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-07-12 RR-179/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-17 RR-093/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-15 RR-101/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-13 RR-034/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-03-14 RR-032/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-16 RR-132/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-30 RR-149/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-26 RR-062/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-01-04 RR-009/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-10-06 RR-176/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2018-01-17 RR-211/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-15 RR-114/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-12-13 RR-128/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2018-01-26 RR-215/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-03-22 RR-030/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-15 RR-166/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-05 RR-039/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-19 RR-038/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-16 RR-090/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-02-16 RR-019/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-10 RR-131/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-16 RR-206/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-22 RR-187/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-12 RR-080/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-28 RR-194/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-03-22 RR-029/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-09 RR-064/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-27 RR-146/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-12 RR-092/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2015-11-26 RR-001/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-06-06 RR-092/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2018-01-19 RR-176/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-02-19 RR-016/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-07-27 RR-186/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-02 RR-159/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-28 RR-150/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-04-28 RR-157/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-12-15 RR-159/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-03 RR-055/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-09 RR-075/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-05 RR-063/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-28 RR-159/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-03-04 RR-020/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-15 RR-151/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-06 RR-018/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-05 RR-060/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-20 RR-135/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-09 RR-044/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-18 RR-169/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-29 RR-115/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2018-01-19 RR-216/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-08 RR-152/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-20 RR-035/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-25 RR-078/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-02-27 RR-143/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-05 RR-136/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-03 RR-138/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2015-12-11 RR-008/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-31 RR-147/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-13 RR-079/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-08-08 RR-190/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-05-31 RR-047/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-04-25 RR-154/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-23 RR-085/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-02-02 RR-015/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-17 RR-112/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-02-24 RR-145/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-07 RR-048/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-28 RR-018/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-20 RR-046/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-03-02 RR-144/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-17 RR-208/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-02-28 RR-140/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-09-29 RR-200/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-06-03 RR-041/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-10 RR-145/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-12-19 RR-125/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-09-29 RR-197/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-08 RR-051/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-11-23 RR-117/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-12-13 RR-124/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-05-10 RR-037/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-08-02 RR-066/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-08 RR-083/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-20 RR-099/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-11 RR-163/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-04-29 RR-026/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-07-06 RR-061/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-12 RR-100/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-11-09 RR-209/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-12 RR-086/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-10-18 RR-095/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-27 RR-081/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-01-19 RR-134/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-05-19 RR-165/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2016-09-29 RR-089/QSM_SPGR_GE/src/kspace.mat', '/home/Staff/uqhsun8/sunlab/Share/raw_kspace_128/MS_TIA_kspace_trainData/MS/2017-12-07 RR-212/QSM_SPGR_GE/src/kspace.mat']


# load in the undersampling mask
under_mask = loadmat('/home/Staff/uqhsun8/mask_AF8.mat')['mask']
# read in k
for k_3d_path in k_raw_list:
    k_3d = loadmat(k_3d_path)['k']
    img_3d = FFT.fftshift(FFT.fftn(FFT.fftshift(k_3d, axes=(0, 1, 2)), axes=(0, 1, 2)), axes=(0, 1, 2))
        
    k_2d = FFT.fftshift(FFT.fft(FFT.fftshift(k_3d, axes=2), axis=2), axes=2)
    k_2d_undersampled = k_2d * np.expand_dims(under_mask, (2,3))

    img_2d_undersampled = FFT.fftshift(FFT.fftn(FFT.fftshift(k_2d_undersampled, axes=(0, 1)), axes=(0, 1)), axes=(0, 1))

    img_cat_channels = np.stack((img_3d, img_2d_undersampled, k_2d, k_2d_undersampled), -1)

    img_cat_channels = rearrange(img_cat_channels, 'x y z echo channel -> x y (z echo) channel')


    pathname = os.path.dirname(str(k_3d_path))
    pathname = re.sub(r"\.", '', re.sub(r"\/", '_', re.sub(r"\s+",'_',pathname)))
    pathname = os.path.join("/home/Staff/uqhsun8/sunlab/Hongfu/complex_2d_images_full_undersampled", pathname)
    os.makedirs(pathname, exist_ok=True)
    slice_echo_no = 0
    for slice_echo_no in range(img_cat_channels.shape[2]):
        filename = pathname + '/' + str(slice_echo_no) + '.npy'
        np.save(filename, img_cat_channels[:,:,slice_echo_no,:]) # 2D slices: x, y, channels (full_img, under_img, full_k, under_k)
        slice_echo_no += 1



